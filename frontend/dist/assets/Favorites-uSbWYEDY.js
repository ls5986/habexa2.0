import{O as T,j as e,r as l,u as F,Q as R,B as o,p as B,T as i,d as h,a as f,K as _,z as y,E as b,I as v,o as z}from"./index-BYznCITu.js";import{S as C}from"./Star-CgKh2XAl.js";import{R as k}from"./Refresh-LThyftzO.js";import{T as E}from"./TableContainer-DPUwk_up.js";import{T as N,b as I,c as t,a as O}from"./TableRow-hZp2xtn3.js";import{T as H}from"./TableHead-DQ0-QNtv.js";const V=T(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),W=T(e.jsx("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew"),Q=()=>{const[n,x]=l.useState([]),[S,j]=l.useState(!0),[a,u]=l.useState(null),m=F(),{showToast:c}=R(),p=async()=>{j(!0),u(null);try{const r=await z.get("/favorites");x(r.data||[])}catch(r){console.error("Error fetching favorites:",r),u("Failed to load favorites"),c("Failed to load favorites","error")}finally{j(!1)}};l.useEffect(()=>{p()},[]);const w=async r=>{try{await z.delete(`/favorites/${r}`),x(n.filter(s=>s.product_id!==r)),c("Removed from favorites","info")}catch(s){console.error("Error removing favorite:",s),c("Failed to remove","error")}},g=r=>{m(`/products?selected=${r}`)},d=r=>r==null?"—":`$${Number(r).toFixed(2)}`,P=r=>r==null?"—":`${Number(r).toFixed(1)}%`;return S?e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsx(B,{})}):e.jsxs(o,{sx:{p:3},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(C,{sx:{color:"warning.main",fontSize:32}}),e.jsx(i,{variant:"h4",fontWeight:"bold",children:"Favorites"}),e.jsx(h,{label:n.length,color:"primary",size:"small",sx:{ml:1}})]}),e.jsx(f,{startIcon:e.jsx(k,{}),onClick:p,variant:"outlined",children:"Refresh"})]}),a&&e.jsx(_,{severity:"error",sx:{mb:3},children:a}),!a&&n.length===0&&e.jsxs(y,{sx:{p:4,textAlign:"center"},children:[e.jsx(C,{sx:{fontSize:64,color:"action.disabled",mb:2}}),e.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No favorites yet"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Click the star icon on any product to add it to your favorites."}),e.jsx(f,{variant:"contained",onClick:()=>m("/products"),children:"Browse Products"})]}),n.length>0&&e.jsx(E,{component:y,children:e.jsxs(N,{children:[e.jsx(H,{children:e.jsxs(I,{children:[e.jsx(t,{children:"Product"}),e.jsx(t,{children:"ASIN"}),e.jsx(t,{align:"right",children:"Buy Cost"}),e.jsx(t,{align:"right",children:"Sell Price"}),e.jsx(t,{align:"right",children:"ROI"}),e.jsx(t,{align:"right",children:"Profit"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsx(O,{children:n.map(r=>e.jsxs(I,{hover:!0,sx:{cursor:"pointer"},onClick:()=>g(r.product_id),children:[e.jsx(t,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[r.image_url&&e.jsx(o,{component:"img",src:r.image_url,alt:r.title,sx:{width:40,height:40,objectFit:"contain",borderRadius:1}}),e.jsxs(o,{children:[e.jsx(i,{variant:"body2",fontWeight:"medium",noWrap:!0,sx:{maxWidth:300},children:r.title||"Unknown Product"}),r.brand&&e.jsx(i,{variant:"caption",color:"text.secondary",children:r.brand})]})]})}),e.jsx(t,{children:e.jsx(h,{label:r.asin,size:"small",variant:"outlined"})}),e.jsx(t,{align:"right",children:d(r.buy_cost)}),e.jsx(t,{align:"right",children:d(r.sell_price)}),e.jsxs(t,{align:"right",children:[r.roi!=null&&e.jsx(h,{label:P(r.roi),size:"small",color:r.roi>=30?"success":r.roi>=15?"warning":"error"}),r.roi==null&&"—"]}),e.jsx(t,{align:"right",children:e.jsx(i,{color:r.profit>0?"success.main":"error.main",fontWeight:"medium",children:d(r.profit)})}),e.jsxs(t,{align:"center",children:[e.jsx(b,{title:"Open product",children:e.jsx(v,{size:"small",onClick:s=>{s.stopPropagation(),g(r.product_id)},children:e.jsx(W,{fontSize:"small"})})}),e.jsx(b,{title:"Remove from favorites",children:e.jsx(v,{size:"small",color:"error",onClick:s=>{s.stopPropagation(),w(r.product_id)},children:e.jsx(V,{fontSize:"small"})})})]})]},r.id))})]})})]})};export{Q as default};
