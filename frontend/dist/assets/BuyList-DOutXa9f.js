import{c as M,j as e,X as E,Y as Q,A as H,h as l,T as a,$ as U,a as g,r as h,ab as Y,o as y,B as s,p as N,C as q,P as X,M as G,f as T,I as B,q as J}from"./index-BzeS6AUb.js";import{D as K,P as V}from"./plus-BmhBo4bz.js";import{T as z}from"./trash-2-DQAMnqHw.js";import{T as Z,a as ee}from"./TableHead-D-dTs3gH.js";import{T as te,b as D,c as n,a as re}from"./TableRow-BkpfAa8R.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=M("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),O=({open:o,onClose:j,onConfirm:b,title:p,message:m,confirmText:f="Confirm",cancelText:C="Cancel",danger:d=!1})=>e.jsxs(E,{open:o,onClose:j,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(Q,{sx:{display:"flex",alignItems:"center",gap:1},children:[d&&e.jsx(H,{size:20,style:{color:l.error.main}}),e.jsx(a,{variant:"h6",fontWeight:600,children:p})]}),e.jsx(U,{children:e.jsx(a,{variant:"body1",color:"text.secondary",children:m})}),e.jsxs(K,{children:[e.jsx(g,{onClick:j,variant:"outlined",children:C}),e.jsx(g,{onClick:b,variant:"contained",color:d?"error":"primary",sx:{backgroundColor:d?l.error.main:l.purple.main,"&:hover":{backgroundColor:d?l.error.dark:l.purple.dark}},children:f})]})]}),ce=()=>{const[o,j]=h.useState([]),[b,p]=h.useState(!0),[m,f]=h.useState(!1),[C,d]=h.useState(!1),[P,v]=h.useState(!1),[u,k]=h.useState(null),{showToast:i}=Y();h.useEffect(()=>{x()},[]);const x=async()=>{try{p(!0);const t=await y.get("/buy-list");j(t.data||[])}catch(t){console.error("Failed to fetch buy list:",t),i("Failed to load buy list","error")}finally{p(!1)}},w=async(t,r)=>{if(r<1){i("Quantity must be at least 1","warning");return}try{await y.patch(`/buy-list/${t}`,{quantity:r}),i("Quantity updated","success"),x()}catch{i("Failed to update quantity","error")}},F=t=>{k(t),v(!0)},S=async()=>{if(u)try{await y.delete(`/buy-list/${u.id}`),i("Item removed from buy list","success"),v(!1),k(null),x()}catch{i("Failed to remove item","error")}},W=async()=>{try{await y.delete("/buy-list"),i("Buy list cleared","success"),d(!1),x()}catch{i("Failed to clear buy list","error")}},R=async()=>{var t,r;if(o.length===0){i("Buy list is empty","warning");return}f(!0);try{const c=await y.post("/buy-list/create-order");i(`Order created with ${c.data.orders_created} items!`,"success"),x()}catch(c){i(((r=(t=c.response)==null?void 0:t.data)==null?void 0:r.detail)||"Failed to create order","error")}finally{f(!1)}},L=o.reduce((t,r)=>t+(r.quantity||r.moq||1),0),$=o.reduce((t,r)=>{const c=r.quantity||r.moq||1,I=r.buy_cost||0;return t+c*I},0);return b?e.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:e.jsx(N,{})}):o.length===0?e.jsxs(s,{sx:{p:3},children:[e.jsx(s,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:e.jsx(a,{variant:"h4",fontWeight:700,children:"Buy List"})}),e.jsxs(q,{sx:{p:4,textAlign:"center"},children:[e.jsx(X,{size:48,style:{color:"#8B8B9B",margin:"0 auto 16px"}}),e.jsx(a,{variant:"h6",sx:{mb:1},children:"Your buy list is empty"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Add products to your buy list from the Products page"}),e.jsx(g,{variant:"contained",onClick:()=>window.location.href="/products",sx:{backgroundColor:l.purple.main,"&:hover":{backgroundColor:l.purple.dark}},children:"Browse Products"})]})]}):e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(a,{variant:"h4",fontWeight:700,children:"Buy List"}),e.jsxs(s,{display:"flex",gap:2,children:[e.jsx(g,{variant:"outlined",color:"error",startIcon:e.jsx(z,{size:16}),onClick:()=>d(!0),disabled:o.length===0,children:"Clear All"}),e.jsx(g,{variant:"contained",startIcon:e.jsx(G,{size:16}),onClick:R,disabled:m||o.length===0,sx:{backgroundColor:l.purple.main,"&:hover":{backgroundColor:l.purple.dark}},children:m?"Creating Order...":`Create Order (${o.length} items)`})]})]}),e.jsxs(q,{children:[e.jsx(Z,{children:e.jsxs(te,{children:[e.jsx(ee,{children:e.jsxs(D,{children:[e.jsx(n,{children:"Product"}),e.jsx(n,{children:"ASIN"}),e.jsx(n,{align:"right",children:"Unit Cost"}),e.jsx(n,{align:"center",children:"Quantity"}),e.jsx(n,{align:"right",children:"Subtotal"}),e.jsx(n,{align:"right",children:"Actions"})]})}),e.jsx(re,{children:o.map(t=>{const r=t.quantity||t.moq||1,c=t.buy_cost||0,I=r*c;return e.jsxs(D,{children:[e.jsx(n,{children:e.jsxs(s,{display:"flex",alignItems:"center",gap:2,children:[t.image_url?e.jsx(s,{component:"img",src:t.image_url,sx:{width:48,height:48,borderRadius:1,objectFit:"cover"}}):e.jsx(s,{sx:{width:48,height:48,bgcolor:"#252540",borderRadius:1}}),e.jsx(a,{variant:"body2",fontWeight:500,children:t.title||"Unknown Product"})]})}),e.jsx(n,{children:e.jsx(a,{variant:"body2",fontFamily:"monospace",color:"text.secondary",children:t.asin})}),e.jsx(n,{align:"right",children:e.jsx(a,{variant:"body2",children:T(c)})}),e.jsx(n,{align:"center",children:e.jsxs(s,{display:"flex",alignItems:"center",justifyContent:"center",gap:1,children:[e.jsx(B,{size:"small",onClick:()=>w(t.id,r-1),disabled:r<=1,children:e.jsx(se,{size:16})}),e.jsx(J,{type:"number",value:r,onChange:_=>{const A=parseInt(_.target.value)||1;A>=1&&w(t.id,A)},inputProps:{min:1,style:{textAlign:"center",width:60}},size:"small",sx:{width:80}}),e.jsx(B,{size:"small",onClick:()=>w(t.id,r+1),children:e.jsx(V,{size:16})})]})}),e.jsx(n,{align:"right",children:e.jsx(a,{variant:"body2",fontWeight:600,children:T(I)})}),e.jsx(n,{align:"right",children:e.jsx(B,{size:"small",color:"error",onClick:()=>F(t),children:e.jsx(z,{size:16})})})]},t.id)})})]})}),e.jsx(s,{sx:{p:3,borderTop:1,borderColor:"divider"},children:e.jsxs(s,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(s,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Total Items"}),e.jsx(a,{variant:"h6",fontWeight:600,children:L})]}),e.jsxs(s,{textAlign:"right",children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Total Cost"}),e.jsx(a,{variant:"h5",fontWeight:700,color:l.purple.main,children:T($)})]})]})})]}),e.jsx(O,{open:P,onClose:()=>{v(!1),k(null)},onConfirm:S,title:"Remove Item",message:`Remove "${(u==null?void 0:u.title)||(u==null?void 0:u.asin)}" from buy list?`,confirmText:"Remove",danger:!0}),e.jsx(O,{open:C,onClose:()=>d(!1),onConfirm:W,title:"Clear Buy List",message:"Are you sure you want to remove all items from your buy list?",confirmText:"Clear All",danger:!0})]})};export{ce as default};
