import{u as L,r as o,af as O,W as Z,M as G,j as e,B as t,T as a,C as g,b,ac as w,q as j,a as x,h as i,Z as V,a8 as Y,a9 as H,aa as Q,ab as F,F as X,d as N,D as J,e as K}from"./index-D5Lu9gvQ.js";import{R as ee,a as R,h as se}from"./errorHandler-2xpqys1u.js";import{R as W}from"./refresh-cw-N5a38MT3.js";import{D as re}from"./dollar-sign-DurImJFQ.js";import{E as ae}from"./external-link-DKqSwrhW.js";const ce=()=>{const h=L(),[D,P]=o.useState("single"),[l,y]=o.useState(""),[d,f]=o.useState(""),[v,C]=o.useState(1),[A,S]=o.useState(""),[s,u]=o.useState(null),[p,m]=o.useState(null),{analyzeSingle:T,loading:_}=O(),{suppliers:E}=Z(),{showToast:c}=G(),B=async()=>{var r,k,z;if(!l||!d){c("Please enter ASIN and buy cost","error");return}u(null),m(null);try{const n=await T(l,parseFloat(d),v,A||null);if(n.job_id){c("Analysis started! Check Products page for results.","info");return}n.asin||n.product_id?(u(n),c("Analysis complete!","success")):(u({asin:n.asin||l,title:n.title||n.product_title||"Product Analysis",roi:n.roi||((r=n.analysis)==null?void 0:r.roi)||0,net_profit:n.net_profit||((k=n.analysis)==null?void 0:k.net_profit)||0,deal_score:n.deal_score||((z=n.analysis)==null?void 0:z.deal_score)||null,gating_status:n.gating_status||"unknown",meets_threshold:n.meets_threshold||!1}),c("Analysis complete!","success"))}catch(n){const q=se(n,c);m(q)}},I=()=>{u(null),m(null),y(""),f(""),C(1),S("")},M=()=>{s!=null&&s.asin?h(`/products?asin=${s.asin}`):s!=null&&s.product_id?h(`/products?product_id=${s.product_id}`):h("/products")},U=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(r||0),$=r=>!r&&r!==0?"N/A":`${r>=0?"+":""}${r.toFixed(1)}%`;return e.jsxs(t,{children:[e.jsx(a,{variant:"h4",fontWeight:700,mb:1,children:"Analyze Products"}),e.jsx(a,{variant:"body1",color:"text.secondary",mb:4,children:"Enter an ASIN to get instant profitability analysis"}),e.jsx(g,{sx:{mb:4},children:e.jsx(b,{children:e.jsxs(t,{display:"flex",flexDirection:"column",gap:3,children:[e.jsxs(ee,{value:D,onChange:r=>P(r.target.value),row:!0,children:[e.jsx(w,{value:"single",control:e.jsx(R,{}),label:"Single ASIN"}),e.jsx(w,{value:"bulk",control:e.jsx(R,{}),label:"Bulk Analysis"})]}),e.jsxs(t,{display:"flex",gap:2,children:[e.jsx(j,{fullWidth:!0,label:"ASIN",placeholder:"B08XYZ1234",value:l,onChange:r=>y(r.target.value.toUpperCase()),sx:{fontFamily:"monospace"},disabled:!!s}),e.jsx(x,{variant:"contained",startIcon:e.jsx(V,{size:16}),onClick:B,disabled:_||!l||!d||!!s,sx:{backgroundColor:i.purple.main,"&:hover":{backgroundColor:i.purple.dark},minWidth:150},children:_?"Analyzing...":"Analyze"})]}),e.jsxs(t,{display:"flex",gap:2,children:[e.jsx(j,{label:"Your Cost",type:"number",value:d,onChange:r=>f(r.target.value),InputProps:{startAdornment:"$"},sx:{flex:1},disabled:!!s}),e.jsx(j,{label:"MOQ",type:"number",value:v,onChange:r=>C(parseInt(r.target.value)||1),sx:{flex:1},disabled:!!s}),e.jsxs(Y,{sx:{flex:1},children:[e.jsx(H,{children:"Supplier"}),e.jsxs(Q,{value:A,label:"Supplier",onChange:r=>S(r.target.value),disabled:!!s,children:[e.jsx(F,{value:"",children:"None"}),E.map(r=>e.jsx(F,{value:r.id,children:r.name},r.id))]})]})]})]})})}),p&&e.jsx(g,{sx:{mb:4,borderColor:"error.main",border:1},children:e.jsxs(b,{children:[e.jsxs(X,{severity:"error",sx:{mb:2},children:[e.jsx(a,{variant:"body1",fontWeight:600,children:"Analysis Failed"}),e.jsx(a,{variant:"body2",mt:1,children:p})]}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(W,{size:16}),onClick:I,children:"Try Again"})]})}),s&&e.jsx(g,{sx:{mb:4,borderColor:s.roi>=30?"success.main":s.roi>0?"warning.main":"error.main",border:2},children:e.jsxs(b,{children:[e.jsxs(t,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(a,{variant:"h5",fontWeight:700,children:"Analysis Results"}),e.jsx(N,{label:s.roi>=30?"Highly Profitable":s.roi>0?"Profitable":"Unprofitable",color:s.roi>=30?"success":s.roi>0?"warning":"error",sx:{fontWeight:600}})]}),e.jsx(J,{sx:{my:2}}),e.jsxs(t,{display:"flex",flexDirection:"column",gap:2,children:[e.jsxs(t,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",mb:.5,children:"Product Title"}),e.jsx(a,{variant:"body1",fontWeight:600,children:s.title||"N/A"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",mb:.5,children:"ASIN"}),e.jsx(a,{variant:"body1",fontFamily:"monospace",fontWeight:600,children:s.asin||"N/A"})]}),e.jsxs(t,{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:2,mt:2,children:[e.jsxs(t,{sx:{p:2,borderRadius:2,bgcolor:"background.paper",border:"1px solid",borderColor:"divider"},children:[e.jsxs(t,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(K,{size:20,color:s.roi>=30?i.success.main:s.roi>0?i.warning.main:i.error.main}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"ROI"})]}),e.jsx(a,{variant:"h4",fontWeight:700,color:s.roi>=30?"success.main":s.roi>0?"warning.main":"error.main",children:$(s.roi)})]}),e.jsxs(t,{sx:{p:2,borderRadius:2,bgcolor:"background.paper",border:"1px solid",borderColor:"divider"},children:[e.jsxs(t,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(re,{size:20,color:s.net_profit>0?i.success.main:i.error.main}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Net Profit"})]}),e.jsx(a,{variant:"h4",fontWeight:700,color:s.net_profit>0?"success.main":"error.main",children:U(s.net_profit)})]})]}),s.deal_score&&e.jsxs(t,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",mb:.5,children:"Deal Score"}),e.jsx(a,{variant:"body1",fontWeight:600,children:s.deal_score})]}),s.gating_status&&e.jsxs(t,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",mb:.5,children:"Gating Status"}),e.jsx(N,{label:s.gating_status,size:"small",color:s.gating_status==="ungated"?"success":"warning"})]}),e.jsxs(t,{display:"flex",gap:2,mt:3,children:[e.jsx(x,{variant:"contained",startIcon:e.jsx(ae,{size:16}),onClick:M,sx:{backgroundColor:i.purple.main,"&:hover":{backgroundColor:i.purple.dark},flex:1},children:"View Full Details"}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(W,{size:16}),onClick:I,sx:{flex:1},children:"Analyze Another"})]})]})]})}),!s&&!p&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"h6",fontWeight:600,mb:2,children:"ðŸ“‹ Recent Analyses"}),e.jsx(a,{color:"text.secondary",children:"No recent analyses"})]})]})};export{ce as default};
