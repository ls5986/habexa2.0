import{a5 as je,a6 as ve,r as n,a7 as ts,a9 as _e,an as ms,ao as ys,aa as N,j as e,ab as te,J as Ce,ac as ke,O as os,ap as rs,aq as bs,ar as ie,as as js,at as vs,au as _s,av as Cs,aw as ks,u as As,ax as Is,a2 as ws,Q as Ss,B as l,T as d,C as V,b as Y,ak as ye,x as Rs,y as Ge,q as E,a as z,h as _,p as be,Z as Ee,al as zs,s as qe,ad as Oe,ae as Je,af as Ve,ag as ne,K as Fs,d as H,D as Qe,e as Ps,o as le}from"./index-BYznCITu.js";import{h as Ze}from"./errorHandler-l0UVzPhu.js";import{T as $s}from"./trash-2-B_awrX4j.js";import{P as Le}from"./plus-DANvhV5h.js";import{R as Ye}from"./refresh-cw-nAbQQF7o.js";import{D as Ns}from"./dollar-sign-DZEYuNoh.js";import{E as Bs}from"./external-link-6b3xdYup.js";import{G as He}from"./Grid-DCzzsCbl.js";function Us(o){return je("MuiFormGroup",o)}ve("MuiFormGroup",["root","row","error"]);const Ws=["className","row"],Ms=o=>{const{classes:a,row:u,error:c}=o;return ke({root:["root",u&&"row",c&&"error"]},Us,a)},Ts=te("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(o,a)=>{const{ownerState:u}=o;return[a.root,u.row&&a.row]}})(({ownerState:o})=>N({display:"flex",flexDirection:"column",flexWrap:"wrap"},o.row&&{flexDirection:"row"})),Ds=n.forwardRef(function(a,u){const c=ts({props:a,name:"MuiFormGroup"}),{className:m,row:C=!1}=c,B=_e(c,Ws),F=ms(),S=ys({props:c,muiFormControl:F,states:["error"]}),W=N({},c,{row:C,error:S.error}),q=Ms(W);return e.jsx(Ts,N({className:Ce(q.root,m),ownerState:W,ref:u},B))}),Gs=os(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),Es=os(e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),qs=te("span",{name:"MuiRadioButtonIcon",shouldForwardProp:rs})({position:"relative",display:"flex"}),Os=te(Gs,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),Js=te(Es,{name:"MuiRadioButtonIcon"})(({theme:o,ownerState:a})=>N({left:0,position:"absolute",transform:"scale(0)",transition:o.transitions.create("transform",{easing:o.transitions.easing.easeIn,duration:o.transitions.duration.shortest})},a.checked&&{transform:"scale(1)",transition:o.transitions.create("transform",{easing:o.transitions.easing.easeOut,duration:o.transitions.duration.shortest})}));function as(o){const{checked:a=!1,classes:u={},fontSize:c}=o,m=N({},o,{checked:a});return e.jsxs(qs,{className:u.root,ownerState:m,children:[e.jsx(Os,{fontSize:c,className:u.background,ownerState:m}),e.jsx(Js,{fontSize:c,className:u.dot,ownerState:m})]})}const ns=n.createContext(void 0);function Vs(){return n.useContext(ns)}function Qs(o){return je("MuiRadio",o)}const Xe=ve("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Zs=["checked","checkedIcon","color","icon","name","onChange","size","className"],Ls=o=>{const{classes:a,color:u,size:c}=o,m={root:["root",`color${ie(u)}`,c!=="medium"&&`size${ie(c)}`]};return N({},a,ke(m,Qs,a))},Ys=te(js,{shouldForwardProp:o=>rs(o)||o==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(o,a)=>{const{ownerState:u}=o;return[a.root,u.size!=="medium"&&a[`size${ie(u.size)}`],a[`color${ie(u.color)}`]]}})(({theme:o,ownerState:a})=>N({color:(o.vars||o).palette.text.secondary},!a.disableRipple&&{"&:hover":{backgroundColor:o.vars?`rgba(${a.color==="default"?o.vars.palette.action.activeChannel:o.vars.palette[a.color].mainChannel} / ${o.vars.palette.action.hoverOpacity})`:vs(a.color==="default"?o.palette.action.active:o.palette[a.color].main,o.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},a.color!=="default"&&{[`&.${Xe.checked}`]:{color:(o.vars||o).palette[a.color].main}},{[`&.${Xe.disabled}`]:{color:(o.vars||o).palette.action.disabled}}));function Hs(o,a){return typeof a=="object"&&a!==null?o===a:String(o)===String(a)}const Ke=e.jsx(as,{checked:!0}),es=e.jsx(as,{}),ss=n.forwardRef(function(a,u){var c,m;const C=ts({props:a,name:"MuiRadio"}),{checked:B,checkedIcon:F=Ke,color:S="primary",icon:W=es,name:q,onChange:j,size:M="medium",className:k}=C,O=_e(C,Zs),w=N({},C,{color:S,size:M}),T=Ls(w),y=Vs();let v=B;const X=bs(j,y&&y.onChange);let Q=q;return y&&(typeof v>"u"&&(v=Hs(y.value,C.value)),typeof Q>"u"&&(Q=y.name)),e.jsx(Ys,N({type:"radio",icon:n.cloneElement(W,{fontSize:(c=es.props.fontSize)!=null?c:M}),checkedIcon:n.cloneElement(F,{fontSize:(m=Ke.props.fontSize)!=null?m:M}),ownerState:w,classes:T,name:Q,checked:v,onChange:X,ref:u,className:Ce(T.root,k)},O))});function Xs(o){return je("MuiRadioGroup",o)}ve("MuiRadioGroup",["root","row","error"]);const Ks=["actions","children","className","defaultValue","name","onChange","value"],et=o=>{const{classes:a,row:u,error:c}=o;return ke({root:["root",u&&"row",c&&"error"]},Xs,a)},st=n.forwardRef(function(a,u){const{actions:c,children:m,className:C,defaultValue:B,name:F,onChange:S,value:W}=a,q=_e(a,Ks),j=n.useRef(null),M=et(a),[k,O]=_s({controlled:W,default:B,name:"RadioGroup"});n.useImperativeHandle(c,()=>({focus:()=>{let v=j.current.querySelector("input:not(:disabled):checked");v||(v=j.current.querySelector("input:not(:disabled)")),v&&v.focus()}}),[]);const w=Cs(u,j),T=ks(F),y=n.useMemo(()=>({name:T,onChange(v){O(v.target.value),S&&S(v,v.target.value)},value:k}),[T,S,O,k]);return e.jsx(ns.Provider,{value:y,children:e.jsx(Ds,N({role:"radiogroup",ref:w,className:Ce(M.root,C)},q,{children:m}))})}),dt=()=>{var Fe,Pe;const o=As(),[a,u]=n.useState("single"),[c,m]=n.useState("asin"),[C,B]=n.useState(""),[F,S]=n.useState(""),[W,q]=n.useState(1),[j,M]=n.useState(""),[k,O]=n.useState(!1),[w,T]=n.useState(1),[y,v]=n.useState(""),[X,Q]=n.useState(1),[K,ce]=n.useState(""),[r,P]=n.useState(null),[de,U]=n.useState(null),[D,b]=n.useState(!1),[Ae,Ie]=n.useState(!1),[ee,Z]=n.useState([]),A=n.useRef(null),we=n.useMemo(()=>k&&w>0&&y?(parseFloat(y)/w).toFixed(4):j,[k,w,y,j]),[R,oe]=n.useState([{asin:"",buy_cost:"",moq:1}]),[I,re]=n.useState(null),{analyzeSingle:ls,analyzeBatch:is,loading:ue}=Is(),{suppliers:Se}=ws(),{showToast:h}=Ss();n.useEffect(()=>{try{const s=localStorage.getItem("recentAnalyses");s&&Z(JSON.parse(s))}catch(s){console.error("Failed to load recent analyses:",s)}},[]),n.useEffect(()=>{if(ee.length>0)try{localStorage.setItem("recentAnalyses",JSON.stringify(ee.slice(0,10)))}catch(s){console.error("Failed to save recent analyses:",s)}},[ee]),n.useEffect(()=>()=>{A.current&&(A.current(),A.current=null)},[]);const cs=async()=>{a==="single"?await ds():await Re()},ds=async()=>{const s=c==="asin"?C:F;if(!s){h(`Please enter ${c.toUpperCase()}`,"error");return}const i=k?parseFloat(y)/w:parseFloat(j);if(!i||i<=0){h("Please enter a valid buy cost","error");return}P(null),U(null),b(!0),A.current&&(A.current(),A.current=null);try{const t=await ls(s,i,X,K||null,c,W,{pack_size:k?w:null,wholesale_cost:k?parseFloat(y):null});if(console.log("âœ… Analysis API response:",t),t&&t.result&&t.status==="completed"){console.log("âœ… Analysis completed synchronously:",t.result);const x={asin:t.asin,title:t.result.title||"Unknown",deal_score:t.result.deal_score??"N/A",net_profit:t.result.net_profit??0,roi:t.result.roi??0,gating_status:t.result.gating_status||"unknown",meets_threshold:t.result.meets_threshold??!1,is_profitable:(t.result.net_profit||0)>0,sell_price:t.result.sell_price,buy_cost:t.result.buy_cost||parseFloat(j),product_id:t.product_id,image_url:t.result.image_url,brand:t.result.brand,category:t.result.category};P(x),b(!1),h("Analysis complete!","success"),Z(G=>[x,...G].slice(0,10));return}if(t&&t.job_id){console.log("âš ï¸ Got job_id response (should only happen for batch):",t.job_id),h("Analysis started! Waiting for results...","info");const x=()=>{let G=1e3;const xs=1e4;let ae,$e=!1;const Ne=t.job_id,ge=async()=>{var Be,Ue,We,Me,Te,De;if($e){console.log("âŒ Polling cancelled");return}try{console.log(`ðŸ”„ Polling job: ${Ne} (interval: ${G}ms)`);const f=(await le.get(`/jobs/${Ne}`)).data;if(console.log(`ðŸ“Š Job status: ${f.status}`,f),f.status==="completed"){console.log("âœ… Job completed! Fetching results...");try{const J=t.product_id||((Be=f.metadata)==null?void 0:Be.product_id),me=t.asin||((Ue=f.metadata)==null?void 0:Ue.asin);console.log("ðŸ“¦ Fetching data for product_id:",J,"asin:",me);try{const $=await le.get(`/deals?asin=${me}`),p=(Array.isArray($.data)?$.data:Array.isArray((We=$.data)==null?void 0:We.deals)?$.data.deals:[]).find(L=>L.asin===me);if(p&&(p.deal_score!==void 0||p.roi!==void 0)){const L={asin:p.asin,title:p.title||p.product_title||"Unknown",deal_score:p.deal_score??"N/A",net_profit:p.net_profit??p.profit??0,roi:p.roi??0,gating_status:p.gating_status||"unknown",meets_threshold:p.meets_threshold??!1,is_profitable:(p.net_profit||p.profit||0)>0,sell_price:p.sell_price,buy_cost:p.buy_cost||parseFloat(j),product_id:J,image_url:p.image_url,brand:p.brand,category:p.category};P(L),b(!1),h("Analysis complete!","success"),Z(gs=>[L,...gs].slice(0,10));return}}catch($){console.warn("Could not fetch from deals endpoint:",$)}if(J){const g=(await le.get(`/products/${J}`)).data,p={asin:g.asin,title:g.title||"Unknown",deal_score:g.deal_score||"N/A",net_profit:g.net_profit||g.profit||0,roi:g.roi||0,gating_status:g.gating_status||"unknown",meets_threshold:g.meets_threshold??!1,is_profitable:(g.net_profit||g.profit||0)>0,sell_price:g.sell_price,buy_cost:g.buy_cost||parseFloat(j),product_id:J,image_url:g.image_url,brand:g.brand,category:g.category};P(p),b(!1),h("Analysis complete!","success"),Z(L=>[p,...L].slice(0,10));return}if(f.result){console.log("âœ… Using job.result:",f.result);const $={asin:f.result.asin||((Me=f.metadata)==null?void 0:Me.asin)||C,title:f.result.title||f.result.product_title||"Unknown",deal_score:f.result.deal_score??"N/A",net_profit:f.result.net_profit??f.result.profit??0,roi:f.result.roi??0,gating_status:f.result.gating_status||"unknown",meets_threshold:f.result.meets_threshold??!1,is_profitable:(f.result.net_profit||f.result.profit||0)>0,product_id:t.product_id};P($),b(!1),h("Analysis complete!","success"),Z(g=>[$,...g].slice(0,10));return}console.log("âš ï¸ No product/deal data found, showing basic info"),P({asin:t.asin||C,title:"Analysis completed - check Products page for details",product_id:t.product_id}),b(!1),h("Analysis complete! Check Products page for full details.","success")}catch(J){console.error("Failed to fetch analysis results:",J),b(!1),h("Analysis completed but could not load results. Check Products page.","warning")}return}else if(f.status==="failed"){b(!1),h("Analysis failed. Please try again.","error"),U("Analysis job failed");return}G=Math.min(G*2,xs),ae=setTimeout(ge,G)}catch(se){if(console.error("âŒ Error polling job:",se),console.error("Error details:",(Te=se.response)==null?void 0:Te.data,se.message),((De=se.response)==null?void 0:De.status)===404){console.error("âŒ Job not found (404)"),b(!1),h("Job not found","warning"),U("Analysis job not found");return}console.log(`âš ï¸ Retrying poll in ${G}ms after error`),ae=setTimeout(ge,G)}};return ge(),()=>{$e=!0,ae&&clearTimeout(ae)}};A.current=x(),console.log("âœ… Polling function started, cleanup stored");return}t.asin||t.product_id?(console.log("âœ… Direct result (no job_id):",t),P(t),b(!1),h("Analysis complete!","success"),Z(x=>[t,...x].slice(0,10))):(console.error("âŒ Unexpected response format:",t),b(!1),U("Unexpected response format from analysis API. Expected job_id or product data."))}catch(t){console.error("âŒ Analysis error:",t),b(!1);const x=Ze(t,h);U(x)}},Re=async()=>{const s=R.filter(i=>i.asin&&i.buy_cost);if(s.length===0){h("Please enter at least one ASIN and buy cost","error");return}re(null),U(null),b(!0),A.current&&(A.current(),A.current=null);try{const i=s.map(x=>({asin:x.asin.trim().toUpperCase(),buy_cost:parseFloat(x.buy_cost),moq:parseInt(x.moq)||1,supplier_id:K||null})),t=await is(i);if(console.log("âœ… Batch analysis response:",t),t.mode==="sync")console.log("âœ… Synchronous batch analysis - instant results!"),re({mode:"sync",total:t.total,results:t.results||[]}),b(!1),h(`âœ… Analyzed ${t.total} product${t.total>1?"s":""} instantly!`,"success");else if(t.mode==="async")console.log("â³ Async batch analysis - polling job:",t.job_id),h(`â³ Analyzing ${t.total} products in background...`,"info"),o(`/jobs/${t.job_id}`),b(!1);else throw new Error("Unexpected response format")}catch(i){console.error("âŒ Batch analysis error:",i),b(!1);const t=Ze(i,h);U(t)}},us=()=>{oe([...R,{asin:"",buy_cost:"",moq:1}])},ps=s=>{R.length>1&&oe(R.filter((i,t)=>t!==s))},pe=(s,i,t)=>{const x=[...R];x[s]={...x[s],[i]:t},oe(x)},he=()=>{A.current&&(A.current(),A.current=null),P(null),re(null),U(null),b(!1),m("asin"),B(""),S(""),q(1),M(""),O(!1),T(1),v(""),Q(1),ce(""),oe([{asin:"",buy_cost:"",moq:1}])},hs=async()=>{var s,i;if(!r||!r.asin){h("No analysis result to save","error");return}Ie(!0);try{const t={asin:r.asin,buy_cost:parseFloat(we)||parseFloat(j)||0,moq:X||1,supplier_id:K||null,notes:null,upc:F||null,pack_size:k?w:null,wholesale_cost:k&&y?parseFloat(y):null},x=await le.post("/analyze/save-product",t);h(x.data.message||"Product saved! Full analysis is running in the background.","success"),setTimeout(()=>{o("/products")},1500)}catch(t){console.error("Failed to save product:",t),h(((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.detail)||"Failed to save product","error")}finally{Ie(!1)}},ze=s=>{P(s)},fs=()=>{r!=null&&r.asin?o(`/products?asin=${r.asin}`):r!=null&&r.product_id?o(`/products?product_id=${r.product_id}`):o("/products")},fe=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(s||0),xe=s=>!s&&s!==0?"N/A":`${s>=0?"+":""}${s.toFixed(1)}%`;return e.jsxs(l,{children:[e.jsx(d,{variant:"h4",fontWeight:700,mb:1,children:"Analyze Products"}),e.jsx(d,{variant:"body1",color:"text.secondary",mb:4,children:"Enter an ASIN to get instant profitability analysis"}),e.jsx(V,{sx:{mb:4},children:e.jsx(Y,{children:e.jsxs(l,{display:"flex",flexDirection:"column",gap:3,children:[e.jsxs(st,{value:a,onChange:s=>{u(s.target.value),P(null),re(null),U(null)},row:!0,children:[e.jsx(ye,{value:"single",control:e.jsx(ss,{}),label:"Single ASIN"}),e.jsx(ye,{value:"bulk",control:e.jsx(ss,{}),label:"Bulk Analysis"})]}),a==="single"?e.jsxs(e.Fragment,{children:[e.jsxs(l,{children:[e.jsx(d,{variant:"body2",color:"text.secondary",mb:1,children:"Identifier Type"}),e.jsxs(Rs,{value:c,exclusive:!0,onChange:(s,i)=>{i!==null&&(m(i),B(""),S(""))},fullWidth:!0,disabled:!!r,children:[e.jsx(Ge,{value:"asin",children:"ASIN"}),e.jsx(Ge,{value:"upc",children:"UPC"})]})]}),e.jsxs(l,{display:"flex",gap:2,children:[e.jsx(E,{fullWidth:!0,label:c==="asin"?"ASIN":"UPC",placeholder:c==="asin"?"B08XYZ1234":"123456789012",value:c==="asin"?C:F,onChange:s=>{c==="asin"?B(s.target.value.toUpperCase()):S(s.target.value)},sx:{fontFamily:"monospace"},disabled:!!r}),e.jsx(z,{variant:"contained",startIcon:D?e.jsx(be,{size:16,color:"inherit"}):e.jsx(Ee,{size:16}),onClick:cs,disabled:ue||D||!(c==="asin"?C:F)||!j&&!y||!!r,sx:{backgroundColor:_.purple.main,"&:hover":{backgroundColor:_.purple.dark},minWidth:150},children:D?"Analyzing...":ue?"Starting...":"Analyze"})]}),e.jsx(ye,{control:e.jsx(zs,{checked:k,onChange:s=>O(s.target.checked),disabled:!!r}),label:"This is a pack/case (wholesale pricing)"}),k?e.jsx(e.Fragment,{children:e.jsxs(l,{display:"flex",gap:2,children:[e.jsx(E,{label:"Pack Size",type:"number",value:w,onChange:s=>T(parseInt(s.target.value)||1),helperText:"Units per pack",sx:{flex:1},disabled:!!r}),e.jsx(E,{label:"Wholesale Cost (per pack)",type:"number",value:y,onChange:s=>v(s.target.value),InputProps:{startAdornment:e.jsx(qe,{position:"start",children:"$"})},helperText:`Per unit: $${we||"0.00"}`,sx:{flex:1},disabled:!!r})]})}):e.jsx(E,{label:"Your Cost (per unit)",type:"number",value:j,onChange:s=>M(s.target.value),InputProps:{startAdornment:e.jsx(qe,{position:"start",children:"$"})},fullWidth:!0,disabled:!!r}),e.jsxs(l,{display:"flex",gap:2,children:[e.jsx(E,{label:"MOQ",type:"number",value:X,onChange:s=>Q(parseInt(s.target.value)||1),helperText:"Minimum Order Quantity",sx:{flex:1},disabled:!!r}),e.jsxs(Oe,{sx:{flex:1},children:[e.jsx(Je,{children:"Supplier"}),e.jsxs(Ve,{value:K,label:"Supplier",onChange:s=>ce(s.target.value),disabled:!!r,children:[e.jsx(ne,{value:"",children:"None"}),Se.map(s=>e.jsx(ne,{value:s.id,children:s.name},s.id))]})]})]})]}):e.jsx(e.Fragment,{children:e.jsxs(l,{display:"flex",flexDirection:"column",gap:2,children:[R.map((s,i)=>e.jsxs(l,{display:"flex",gap:2,alignItems:"center",children:[e.jsx(E,{label:"ASIN",placeholder:"B08XYZ1234",value:s.asin,onChange:t=>pe(i,"asin",t.target.value.toUpperCase()),sx:{fontFamily:"monospace",flex:2},disabled:!!I}),e.jsx(E,{label:"Cost",type:"number",value:s.buy_cost,onChange:t=>pe(i,"buy_cost",t.target.value),InputProps:{startAdornment:"$"},sx:{flex:1},disabled:!!I}),e.jsx(E,{label:"MOQ",type:"number",value:s.moq,onChange:t=>pe(i,"moq",t.target.value),sx:{width:100},disabled:!!I}),R.length>1&&e.jsx(z,{variant:"outlined",color:"error",onClick:()=>ps(i),disabled:!!I,sx:{minWidth:40},children:e.jsx($s,{size:16})})]},i)),e.jsxs(l,{display:"flex",gap:2,alignItems:"center",children:[e.jsx(z,{variant:"outlined",startIcon:e.jsx(Le,{size:16}),onClick:us,disabled:!!I,children:"Add Another ASIN"}),e.jsxs(Oe,{sx:{flex:1,maxWidth:200},children:[e.jsx(Je,{children:"Supplier (All)"}),e.jsxs(Ve,{value:K,label:"Supplier (All)",onChange:s=>ce(s.target.value),disabled:!!I,children:[e.jsx(ne,{value:"",children:"None"}),Se.map(s=>e.jsx(ne,{value:s.id,children:s.name},s.id))]})]})]}),e.jsx(z,{variant:"contained",startIcon:D?e.jsx(be,{size:16,color:"inherit"}):e.jsx(Ee,{size:16}),onClick:Re,disabled:ue||D||!!I||R.filter(s=>s.asin&&s.buy_cost).length===0,sx:{backgroundColor:_.purple.main,"&:hover":{backgroundColor:_.purple.dark},mt:1},children:D?"Analyzing...":`Analyze ${R.filter(s=>s.asin&&s.buy_cost).length} Product${R.filter(s=>s.asin&&s.buy_cost).length!==1?"s":""}`}),e.jsx(d,{variant:"caption",color:"text.secondary",sx:{mt:-1},children:R.filter(s=>s.asin&&s.buy_cost).length<=10?"âš¡ Results will appear instantly (â‰¤10 products)":"â³ Analysis will run in background (track progress on Jobs page)"})]})})]})})}),de&&e.jsx(V,{sx:{mb:4,borderColor:"error.main",border:1},children:e.jsxs(Y,{children:[e.jsxs(Fs,{severity:"error",sx:{mb:2},children:[e.jsx(d,{variant:"body1",fontWeight:600,children:"Analysis Failed"}),e.jsx(d,{variant:"body2",mt:1,children:de})]}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(Ye,{size:16}),onClick:he,children:"Try Again"})]})}),r&&e.jsx(V,{sx:{mb:4,borderColor:r.roi>=30?"success.main":r.roi>0?"warning.main":"error.main",border:2},children:e.jsxs(Y,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(d,{variant:"h5",fontWeight:700,children:"Analysis Results"}),e.jsx(H,{label:r.roi>=30?"Highly Profitable":r.roi>0?"Profitable":"Unprofitable",color:r.roi>=30?"success":r.roi>0?"warning":"error",sx:{fontWeight:600}})]}),e.jsx(Qe,{sx:{my:2}}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:2,children:[e.jsxs(l,{children:[e.jsx(d,{variant:"body2",color:"text.secondary",mb:.5,children:"Product Title"}),e.jsx(d,{variant:"body1",fontWeight:600,children:r.title||"N/A"})]}),e.jsxs(l,{children:[e.jsx(d,{variant:"body2",color:"text.secondary",mb:.5,children:"ASIN"}),e.jsx(d,{variant:"body1",fontFamily:"monospace",fontWeight:600,children:r.asin||"N/A"})]}),e.jsxs(l,{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:2,mt:2,children:[e.jsxs(l,{sx:{p:2,borderRadius:2,bgcolor:"background.paper",border:"1px solid",borderColor:"divider"},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(Ps,{size:20,color:r.roi>=30?_.success.main:r.roi>0?_.warning.main:_.error.main}),e.jsx(d,{variant:"body2",color:"text.secondary",children:"ROI"})]}),e.jsx(d,{variant:"h4",fontWeight:700,color:r.roi>=30?"success.main":r.roi>0?"warning.main":"error.main",children:xe(r.roi)})]}),e.jsxs(l,{sx:{p:2,borderRadius:2,bgcolor:"background.paper",border:"1px solid",borderColor:"divider"},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(Ns,{size:20,color:r.net_profit>0?_.success.main:_.error.main}),e.jsx(d,{variant:"body2",color:"text.secondary",children:"Net Profit"})]}),e.jsx(d,{variant:"h4",fontWeight:700,color:r.net_profit>0?"success.main":"error.main",children:fe(r.net_profit)})]})]}),r.deal_score&&e.jsxs(l,{children:[e.jsx(d,{variant:"body2",color:"text.secondary",mb:.5,children:"Deal Score"}),e.jsx(d,{variant:"body1",fontWeight:600,children:r.deal_score})]}),r.gating_status&&e.jsxs(l,{children:[e.jsx(d,{variant:"body2",color:"text.secondary",mb:.5,children:"Gating Status"}),e.jsx(H,{label:r.gating_status,size:"small",color:r.gating_status==="ungated"?"success":"warning"})]}),e.jsxs(l,{display:"flex",gap:2,mt:3,children:[e.jsx(z,{variant:"contained",startIcon:e.jsx(Bs,{size:16}),onClick:fs,disabled:!r,sx:{backgroundColor:_.purple.main,"&:hover":{backgroundColor:_.purple.dark},flex:1},children:"View Full Analysis"}),e.jsx(z,{variant:"contained",startIcon:e.jsx(Le,{size:16}),onClick:hs,disabled:Ae||!r,sx:{backgroundColor:(Fe=_.success)==null?void 0:Fe.main,"&:hover":{backgroundColor:(Pe=_.success)==null?void 0:Pe.dark},flex:1},children:Ae?"Saving...":"Save as Product"}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(Ye,{size:16}),onClick:he,sx:{flex:1},children:"Analyze Another"})]})]})]})}),I&&I.mode==="sync"&&e.jsx(V,{sx:{mb:4,borderColor:"success.main",border:2},children:e.jsxs(Y,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(d,{variant:"h5",fontWeight:700,children:"Batch Analysis Results"}),e.jsx(H,{label:`${I.results.filter(s=>s.status==="success").length}/${I.total} Successful`,color:"success",sx:{fontWeight:600}})]}),e.jsx(Qe,{sx:{my:2}}),e.jsx(l,{display:"flex",flexDirection:"column",gap:2,children:I.results.map((s,i)=>e.jsx(V,{sx:{p:2,border:"1px solid",borderColor:s.status==="success"?"success.main":"error.main",bgcolor:s.status==="success"?"success.50":"error.50"},children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"start",children:[e.jsxs(l,{sx:{flex:1},children:[e.jsx(d,{variant:"subtitle1",fontWeight:600,children:s.asin}),s.status==="success"&&s.result&&e.jsxs(l,{mt:1,children:[e.jsx(d,{variant:"body2",color:"text.secondary",children:s.result.title||"Unknown"}),e.jsxs(l,{display:"flex",gap:2,mt:1,children:[e.jsxs(d,{variant:"body2",children:[e.jsx("strong",{children:"Profit:"})," ",fe(s.result.net_profit||0)]}),e.jsxs(d,{variant:"body2",children:[e.jsx("strong",{children:"ROI:"})," ",xe(s.result.roi||0)]})]})]}),s.status==="failed"&&e.jsx(d,{variant:"body2",color:"error.main",mt:1,children:s.error||"Analysis failed"})]}),e.jsx(H,{label:s.status==="success"?"Success":"Failed",color:s.status==="success"?"success":"error",size:"small"})]})},i))}),e.jsxs(l,{display:"flex",gap:2,mt:3,children:[e.jsx(z,{variant:"contained",onClick:()=>o("/products"),sx:{backgroundColor:_.purple.main,"&:hover":{backgroundColor:_.purple.dark}},children:"View All Products"}),e.jsx(z,{variant:"outlined",onClick:he,children:"Analyze More"})]})]})}),!r&&!I&&!de&&!D&&e.jsxs(e.Fragment,{children:[e.jsx(d,{variant:"h6",fontWeight:600,mb:2,children:"ðŸ“‹ Recent Analyses"}),ee.length===0?e.jsx(d,{color:"text.secondary",children:"No recent analyses"}):e.jsx(He,{container:!0,spacing:2,children:ee.slice(0,6).map((s,i)=>e.jsx(He,{item:!0,xs:12,md:6,children:e.jsx(V,{sx:{cursor:"pointer","&:hover":{boxShadow:3}},onClick:()=>ze(s),children:e.jsx(Y,{children:e.jsxs(l,{display:"flex",gap:2,alignItems:"center",children:[s.image_url&&e.jsx("img",{src:s.image_url,alt:s.title,style:{width:60,height:60,objectFit:"contain",borderRadius:4}}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(d,{variant:"subtitle2",noWrap:!0,fontWeight:600,children:s.title||"Unknown Product"}),e.jsx(d,{variant:"caption",color:"text.secondary",fontFamily:"monospace",children:s.asin}),e.jsxs(l,{display:"flex",gap:1,mt:1,flexWrap:"wrap",children:[s.net_profit!==void 0&&e.jsx(H,{label:`Profit: ${fe(s.net_profit)}`,size:"small",color:s.net_profit>0?"success":"error"}),s.roi!==void 0&&e.jsx(H,{label:`ROI: ${xe(s.roi)}`,size:"small",color:s.roi>=30?"success":s.roi>0?"warning":"error"})]})]}),e.jsx(z,{size:"small",variant:"outlined",onClick:t=>{t.stopPropagation(),ze(s)},children:"View"})]})})})},i))})]}),D&&e.jsx(V,{sx:{mb:4},children:e.jsx(Y,{children:e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",gap:2,py:3,children:[e.jsx(be,{size:40}),e.jsx(d,{variant:"body1",color:"text.secondary",children:"Analyzing product... This may take a few seconds."})]})})})]})};export{dt as default};
