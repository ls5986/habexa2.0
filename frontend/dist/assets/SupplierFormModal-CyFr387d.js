import{r,a2 as B,Q as F,j as a,$ as R,a0 as z,T as M,a as y,am as K,a1 as Q,B as d,q as n,d as X,h as A}from"./index-BYznCITu.js";import{D as $}from"./DialogActions-DoklkOxt.js";const J=({open:W,onClose:o,supplier:t=null})=>{const[p,g]=r.useState(""),[T,x]=r.useState(""),[w,b]=r.useState(""),[C,f]=r.useState(""),[D,S]=r.useState(""),[E,j]=r.useState(""),[u,m]=r.useState([]),[c,N]=r.useState(""),[s,k]=r.useState(!1),{createSupplier:I,updateSupplier:P,saving:l}=B(),{showToast:h}=F(),v=!!t;r.useEffect(()=>{t?(g(t.name||""),x(t.telegram_username||""),b(t.whatsapp_number||""),f(t.email||""),S(t.website||""),j(t.notes||""),m(t.tags||[])):(g(""),x(""),b(""),f(""),S(""),j(""),m([]))},[t,W]);const U=()=>{c.trim()&&!u.includes(c.trim())&&(m([...u,c.trim()]),N(""))},_=e=>{m(u.filter(i=>i!==e))},q=async e=>{if(e.preventDefault(),!p.trim()){h("Supplier name is required","error");return}if(!(s||l))try{k(!0);const i={name:p.trim(),telegram_username:T.trim()||null,whatsapp_number:w.trim()||null,email:C.trim()||null,website:D.trim()||null,notes:E.trim()||null,tags:u.length>0?u:null};v?(await P(t.id,i),h("Supplier updated successfully","success")):(await I(i),h("Supplier created successfully","success")),o()}catch(i){console.error("Supplier save error:",i),h(i.message||"Failed to save supplier","error")}finally{k(!1)}};return a.jsxs(R,{open:W,onClose:o,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3}},children:[a.jsxs(z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2},children:[a.jsx(M,{variant:"h6",fontWeight:600,children:v?"Edit Supplier":"Add New Supplier"}),a.jsx(y,{onClick:o,sx:{minWidth:"auto",p:1},children:a.jsx(K,{size:20})})]}),a.jsxs("form",{onSubmit:q,children:[a.jsx(Q,{children:a.jsxs(d,{display:"flex",flexDirection:"column",gap:3,children:[a.jsx(n,{label:"Supplier Name",value:p,onChange:e=>g(e.target.value),required:!0,fullWidth:!0,disabled:s||l}),a.jsxs(d,{display:"flex",gap:2,children:[a.jsx(n,{label:"Telegram Username",placeholder:"@username",value:T,onChange:e=>x(e.target.value),fullWidth:!0,disabled:s||l}),a.jsx(n,{label:"WhatsApp Number",placeholder:"+1234567890",value:w,onChange:e=>b(e.target.value),fullWidth:!0,disabled:s||l})]}),a.jsxs(d,{display:"flex",gap:2,children:[a.jsx(n,{label:"Email",type:"email",value:C,onChange:e=>f(e.target.value),fullWidth:!0,disabled:s||l}),a.jsx(n,{label:"Website",placeholder:"https://...",value:D,onChange:e=>S(e.target.value),fullWidth:!0,disabled:s||l})]}),a.jsxs(d,{children:[a.jsx(n,{label:"Tags",placeholder:"Type and press Enter to add",value:c,onChange:e=>N(e.target.value),onKeyPress:e=>{e.key==="Enter"&&(e.preventDefault(),U())},fullWidth:!0,disabled:s||l,helperText:"Press Enter to add a tag"}),a.jsx(d,{display:"flex",gap:1,flexWrap:"wrap",mt:1,children:u.map((e,i)=>a.jsx(X,{label:e,onDelete:()=>_(e),size:"small"},i))})]}),a.jsx(n,{label:"Notes",value:E,onChange:e=>j(e.target.value),multiline:!0,rows:4,fullWidth:!0,disabled:s||l})]})}),a.jsxs($,{sx:{px:3,pb:3},children:[a.jsx(y,{onClick:o,disabled:s||l,children:"Cancel"}),a.jsx(y,{type:"submit",variant:"contained",disabled:s||l||!p.trim(),sx:{backgroundColor:A.purple.main,"&:hover":{backgroundColor:A.purple.dark}},children:s||l?"Saving...":v?"Update Supplier":"Create Supplier"})]})]})]})};export{J as S};
