import{c as E,j as e,X as Q,Y as H,A as U,h as l,T as a,$ as Y,a as g,r as h,ab as N,o as y,B as s,p as X,C as z,P as G,M as J,f as T,I as A,q as K}from"./index-iiuQpHm4.js";import{D as V,P as Z}from"./plus-BCMXk6dC.js";import{T as D}from"./trash-2-D2Ri91-c.js";import{T as ee,a as re}from"./TableHead-BcgBsL8-.js";import{T as te,b as O,c as n,a as se}from"./TableRow-CTdh-9Sf.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=E("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),P=({open:o,onClose:j,onConfirm:b,title:p,message:m,confirmText:f="Confirm",cancelText:C="Cancel",danger:d=!1})=>e.jsxs(Q,{open:o,onClose:j,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(H,{sx:{display:"flex",alignItems:"center",gap:1},children:[d&&e.jsx(U,{size:20,style:{color:l.error.main}}),e.jsx(a,{variant:"h6",fontWeight:600,children:p})]}),e.jsx(Y,{children:e.jsx(a,{variant:"body1",color:"text.secondary",children:m})}),e.jsxs(V,{children:[e.jsx(g,{onClick:j,variant:"outlined",children:C}),e.jsx(g,{onClick:b,variant:"contained",color:d?"error":"primary",sx:{backgroundColor:d?l.error.main:l.purple.main,"&:hover":{backgroundColor:d?l.error.dark:l.purple.dark}},children:f})]})]}),de=()=>{const[o,j]=h.useState([]),[b,p]=h.useState(!0),[m,f]=h.useState(!1),[C,d]=h.useState(!1),[F,v]=h.useState(!1),[u,k]=h.useState(null),{showToast:i}=N();h.useEffect(()=>{x()},[]);const x=async()=>{try{p(!0);const r=await y.get("/buy-list");j(r.data||[])}catch(r){console.error("Failed to fetch buy list:",r),i("Failed to load buy list","error")}finally{p(!1)}},w=async(r,t)=>{if(t<1){i("Quantity must be at least 1","warning");return}try{await y.patch(`/buy-list/${r}`,{quantity:t}),i("Quantity updated","success"),x()}catch{i("Failed to update quantity","error")}},S=r=>{k(r),v(!0)},W=async()=>{if(u)try{await y.delete(`/buy-list/${u.id}`),i("Item removed from buy list","success"),v(!1),k(null),x()}catch{i("Failed to remove item","error")}},R=async()=>{try{await y.delete("/buy-list"),i("Buy list cleared","success"),d(!1),x()}catch{i("Failed to clear buy list","error")}},L=async()=>{var r,t;if(o.length===0){i("Buy list is empty","warning");return}f(!0);try{const c=await y.post("/buy-list/create-order");i(`Order created with ${c.data.orders_created} items!`,"success"),x()}catch(c){i(((t=(r=c.response)==null?void 0:r.data)==null?void 0:t.detail)||"Failed to create order","error")}finally{f(!1)}},B=Array.isArray(o)?o:[],$=B.reduce((r,t)=>r+(t.quantity||t.moq||1),0),_=B.reduce((r,t)=>{const c=t.quantity||t.moq||1,I=t.buy_cost||0;return r+c*I},0);return b?e.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:e.jsx(X,{})}):o.length===0?e.jsxs(s,{sx:{p:3},children:[e.jsx(s,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:e.jsx(a,{variant:"h4",fontWeight:700,children:"Buy List"})}),e.jsxs(z,{sx:{p:4,textAlign:"center"},children:[e.jsx(G,{size:48,style:{color:"#8B8B9B",margin:"0 auto 16px"}}),e.jsx(a,{variant:"h6",sx:{mb:1},children:"Your buy list is empty"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Add products to your buy list from the Products page"}),e.jsx(g,{variant:"contained",onClick:()=>window.location.href="/products",sx:{backgroundColor:l.purple.main,"&:hover":{backgroundColor:l.purple.dark}},children:"Browse Products"})]})]}):e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(a,{variant:"h4",fontWeight:700,children:"Buy List"}),e.jsxs(s,{display:"flex",gap:2,children:[e.jsx(g,{variant:"outlined",color:"error",startIcon:e.jsx(D,{size:16}),onClick:()=>d(!0),disabled:o.length===0,children:"Clear All"}),e.jsx(g,{variant:"contained",startIcon:e.jsx(J,{size:16}),onClick:L,disabled:m||o.length===0,sx:{backgroundColor:l.purple.main,"&:hover":{backgroundColor:l.purple.dark}},children:m?"Creating Order...":`Create Order (${o.length} items)`})]})]}),e.jsxs(z,{children:[e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs(O,{children:[e.jsx(n,{children:"Product"}),e.jsx(n,{children:"ASIN"}),e.jsx(n,{align:"right",children:"Unit Cost"}),e.jsx(n,{align:"center",children:"Quantity"}),e.jsx(n,{align:"right",children:"Subtotal"}),e.jsx(n,{align:"right",children:"Actions"})]})}),e.jsx(se,{children:o.map(r=>{const t=r.quantity||r.moq||1,c=r.buy_cost||0,I=t*c;return e.jsxs(O,{children:[e.jsx(n,{children:e.jsxs(s,{display:"flex",alignItems:"center",gap:2,children:[r.image_url?e.jsx(s,{component:"img",src:r.image_url,sx:{width:48,height:48,borderRadius:1,objectFit:"cover"}}):e.jsx(s,{sx:{width:48,height:48,bgcolor:"background.paper",borderRadius:1}}),e.jsx(a,{variant:"body2",fontWeight:500,children:r.title||"Unknown Product"})]})}),e.jsx(n,{children:e.jsx(a,{variant:"body2",fontFamily:"monospace",color:"text.secondary",children:r.asin})}),e.jsx(n,{align:"right",children:e.jsx(a,{variant:"body2",children:T(c)})}),e.jsx(n,{align:"center",children:e.jsxs(s,{display:"flex",alignItems:"center",justifyContent:"center",gap:1,children:[e.jsx(A,{size:"small",onClick:()=>w(r.id,t-1),disabled:t<=1,children:e.jsx(ae,{size:16})}),e.jsx(K,{type:"number",value:t,onChange:M=>{const q=parseInt(M.target.value)||1;q>=1&&w(r.id,q)},inputProps:{min:1,style:{textAlign:"center",width:60}},size:"small",sx:{width:80}}),e.jsx(A,{size:"small",onClick:()=>w(r.id,t+1),children:e.jsx(Z,{size:16})})]})}),e.jsx(n,{align:"right",children:e.jsx(a,{variant:"body2",fontWeight:600,children:T(I)})}),e.jsx(n,{align:"right",children:e.jsx(A,{size:"small",color:"error",onClick:()=>S(r),children:e.jsx(D,{size:16})})})]},r.id)})})]})}),e.jsx(s,{sx:{p:3,borderTop:1,borderColor:"divider"},children:e.jsxs(s,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(s,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Total Items"}),e.jsx(a,{variant:"h6",fontWeight:600,children:$})]}),e.jsxs(s,{textAlign:"right",children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Total Cost"}),e.jsx(a,{variant:"h5",fontWeight:700,color:l.purple.main,children:T(_)})]})]})})]}),e.jsx(P,{open:F,onClose:()=>{v(!1),k(null)},onConfirm:W,title:"Remove Item",message:`Remove "${(u==null?void 0:u.title)||(u==null?void 0:u.asin)}" from buy list?`,confirmText:"Remove",danger:!0}),e.jsx(P,{open:C,onClose:()=>d(!1),onConfirm:R,title:"Clear Buy List",message:"Are you sure you want to remove all items from your buy list?",confirmText:"Clear All",danger:!0})]})};export{de as default};
